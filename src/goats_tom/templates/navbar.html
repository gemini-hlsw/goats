{% load static bootstrap4 custom_filters %}
<div class="navbar navbar-expand-md navbar-dark">
  <a class="navbar-brand" href="{% url 'home' %}">
    <img src="{% static 'img/goats-outline.png' %}" alt="Logo" height="48" class="d-inline-block align-text-top">
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#goatsNavbar" aria-controls="goatsNavbar" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="goatsNavbar">
    <ul class="navbar-nav me-auto">
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle {% if request.resolver_match.namespace == 'alerts' %}active fw-bold{% endif %}" title="Search and import targets from brokers" data-toggle="dropdown">Brokers</a>
        <div class="dropdown-menu">
          <a class="dropdown-item" href="{% url 'alerts:create' %}?broker=ANTARES">ANTARES</a>
          <a class="dropdown-item" href="{% url 'alerts:create' %}?broker=ALeRCE">ALeRCE</a>
          <a class="dropdown-item" href="{% url 'alerts:create' %}?broker=Gaia">Gaia</a>
          <a class="dropdown-item" href="{% url 'alerts:create' %}?broker=Scout">Scout</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="{% url 'alerts:list' %}">Saved Queries</a>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle {% if request.path|starts_with:'/targets' %}active fw-bold{% endif %}" title="Create and manage target details" data-toggle="dropdown">Targets</a>
        <div class="dropdown-menu">
          <a class="dropdown-item" href="{% url 'targets:list' %}">Targets</a>
          <a class="dropdown-item" href="{% url 'targets:targetgrouping' %}">Target Grouping</a>
        </div>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle {% if request.path|starts_with:'/observations' %}active fw-bold{% endif %}" title="Manage observations and view facility status" data-toggle="dropdown">Observations</a>
        <div class="dropdown-menu">
          <a class="dropdown-item" href="{% url 'tom_observations:list' %}">Observations</a>
          <a class="dropdown-item" href="{% url 'tom_observations:group-list' %}">Observation Groups</a>
          <a class="dropdown-item" href="{% url 'tom_observations:template-list' %}">Observation Templates</a>
          <a class="dropdown-item" href="{% url 'tom_observations:facility-status' %}">Facility Status</a>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.namespace == 'dataproducts' %}active fw-bold{% endif %}" title="View and manage data products of all observations" href="{% url 'tom_dataproducts:list' %}">Data</a>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'astro-data-lab' %}active fw-bold{% endif %}" title="Open Astro Data Lab science platform" href="{% url 'astro-data-lab' %}">Astro Data Lab</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" target="_blank" title="Open Gemini Explore" href="https://explore.gemini.edu/">Gemini Explore</a>
      </li>
    </ul>
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link px-md-2 py-2" href="https://github.com/gemini-hlsw/goats" target="_blank" title="Go to GOATS GitHub page"><i class="fa-brands fa-github fa-lg"></i><span class=" d-md-none ms-2">GitHub</span></a>
      </li>
      <li class="nav-item">
      <a class="nav-link px-md-2 py-2" href="https://goats.readthedocs.io/en/latest/index.html" target="_blank" title="Documentation and help"><i class="fa-solid fa-book fa-lg"></i><span class=" d-md-none ms-2">Documentation</span></a>
      </li>
      <li class="nav-item">
        <button id="colorThemeToggle" class="nav-link px-md-2 py-2" title="Toggle light/dark mode">
          <i class="fa-solid fa-sun fa-lg"></i><span class="d-md-none ms-2">Theme</span>
        </button>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle px-md-2 py-2 my-auto {% if request.resolver_match.url_name == 'recent_downloads' %}active fw-bold{% endif %}" href="#" id="navbarDownloadLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="View current and past downloads">
          <span id="downloadBadge" class="badge badge-pill badge-primary d-none mt-0">0</span> <i class="fa-solid fa-download fa-lg"></i><span class=" d-md-none ms-2">Downloads</span>
        </a>
        <div class="dropdown-menu dropdown-menu-right download-tasks-container" aria-labelledby="navbarDownloadDropdown">
          <div id="downloadTasksBanner"></div>
          <a href="{% url 'recent_downloads' %}" class="dropdown-item">View Previous Downloads</a>
        </div>
      </li>
      {% if user.is_authenticated %}
      <li class="nav-item dropdown ">
        <a class="nav-link dropdown-toggle {% if request.resolver_match.url_name|starts_with:'user-' %}active fw-bold{% endif %}" title="Manage user settings and preferences" data-toggle="dropdown">
          {{ user.username }}
        </a>
        <div class="dropdown-menu dropdown-menu-right">
          <a class="dropdown-item" href="{% url 'user-list' %}">Users</a>
          <a class="dropdown-item" href="{% url 'user-update' user.id %}">Settings</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="{% url 'logout' %}">Logout</a>
        </div>
      </li>
      {% else %}
      <li class="nav-item {% if request.resolver_match.url_name == 'login' %}active fw-bold{% endif %}">
        <a class="nav-link" href="{% url 'login' %}" title="Login to GOATS">Login</a>
      </li>
      {% endif %}
    </ul>
  </div>
</div>
