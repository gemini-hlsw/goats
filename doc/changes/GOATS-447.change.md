Refactored modal: Improved modal code for maintainability.